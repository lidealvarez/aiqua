<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Anomaly Detection Results</title>
    <style>
        .form-section {
            margin-bottom: 20px;
        }
    </style>
    <script>
        function validateForm() {
            var startMonth = document.getElementById("start_month").value;
            var endMonth = document.getElementById("end_month").value;
            var detailedMonth = document.getElementById("detailed_month").value;

            if ((startMonth && endMonth) && detailedMonth) {
                alert("Please select either a range of months or a detailed single month, not both.");
                return false;
            }

            if ((!startMonth || !endMonth) && !detailedMonth) {
                alert("Please select either a range of months or a detailed single month.");
                return false;
            }

            return true;
        }
    </script>
</head>
<body>
    <h1>Anomaly Detection Results</h1>

    <!-- Upload form with month selection -->
    <form action="/upload" method="post" enctype="multipart/form-data" onsubmit="return validateForm()">
        <div class="form-section">
            <input type="file" name="file" required>
        </div>
        <div class="form-section">
            <label for="start_month">Start Month (YYYY-MM):</label>
            <input type="month" id="start_month" name="start_month">
            <label for="end_month">End Month (YYYY-MM):</label>
            <input type="month" id="end_month" name="end_month">
        </div>
        <div class="form-section">
            <label for="detailed_month">Detailed Month (YYYY-MM):</label>
            <input type="month" id="detailed_month" name="detailed_month">
            <small>Select this for detailed analysis of a single month within the range above.</small>
        </div>
        <input type="submit" value="Upload and Detect Anomalies">
    </form>

    <!-- Display the plot image -->
    {% if plot_url != 'default_value_if_not_set' %}
        <div class="form-section">
            <iframe src="{{ url_for('static', filename=plot_url) }}" style="width:100%; height:600px;"></iframe>
        </div>
    {% else %}
        <p>No plot available. Please upload a file and select months.</p>
    {% endif %}
</body>
</html>